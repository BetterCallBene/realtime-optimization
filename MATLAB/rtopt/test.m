
clear;

n = sym('n');
r = sym('r', [3 1]) ;
q = sym('q', [4 1]) ;
omega = sym('omega', [3 1]) ;
v = sym('v', [3 1]) ;

u = sym('u', [4 1]) ;


Iges = sym('Iges', [3 1]);

m = sym ('m');
g = sym ('g');

kT = sym('kT');
kQ = sym('kQ');

d  = sym('d');
IM = sym('IM');

t1 = q(3, :) .^ 2;
t2 = q(4, :) .^ 2;
t3 = q(1, :) .* q(4, :);
t4 = q(2, :) .* q(3, :);
t5 = q(2, :) .* q(4, :);
t6 = q(1, :) .* q(3, :);
t7 = q(2, :) .^ 2;
t8 = q(1, :) .* q(2, :);
t9 = q(3, :) .* q(4, :);
t10 = -2 .* t6 + 2 .* t5;
t11 = 2 .* t8 + 2 .* t9;
t12 = 1 - 2 .* t7 - 2 .* t1;
t13 = u(4, :) .^ 2;
t14 = u(2, :) .^ 2;
t15 = u(3, :) .^ 2;
t16 = u(1, :) .^ 2;
t17 = kT .* (t16 + t14 + t15 + t13) - m .* (omega(1, :) .* v(2, :) - omega(2, :) .* v(1) + t12 .* g);
t18 = -u(1, :) + u(2, :) - u(3, :) + u(4, :);
t19 = kT .* d;
t20 = omega(2, :) .* ((-Iges(3) + Iges(2)) .* omega(3, :) + IM .* t18) + t19 .* (t14 - t13);
t18 = omega(1, :) .* ((-Iges(1) + Iges(3)) .* omega(3, :) - IM .* t18) + t19 .* (t15 - t16);
cg = [(1 - 2 .* t1 - 2 .* t2) .* v(1) + (-2 .* t3 + 2 .* t4) .* v(2, :) + (2 .* t6 + 2 .* t5) .* v(3, :) (2 .* t3 + 2 .* t4) .* v(1) + (1 - 2 .* t7 - 2 .* t2) .* v(2, :) + (-2 .* t8 + 2 .* t9) .* v(3, :) t10 .* v(1) + t11 .* v(2, :) + t12 .* v(3, :) -(q(2, :) .* omega(1, :)) / 0.2e1 - (q(3, :) .* omega(2, :)) / 0.2e1 - (q(4, :) .* omega(3, :)) / 0.2e1 (q(1, :) .* omega(1)) / 0.2e1 + (q(3, :) .* omega(3, :)) / 0.2e1 - (q(4, :) .* omega(2, :)) / 0.2e1 (q(1, :) .* omega(2, :)) / 0.2e1 - (q(2, :) .* omega(3, :)) / 0.2e1 + (q(4, :) .* omega(1)) / 0.2e1 (q(1, :) .* omega(3, :)) / 0.2e1 + (q(2, :) .* omega(2, :)) / 0.2e1 - (q(3, :) .* omega(1)) / 0.2e1 -omega(2, :) .* v(3, :) + omega(3, :) .* v(2, :) - t10 .* g -omega(3, :) .* v(1, :) + omega(1) .* v(3, :) - t11 .* g 1 / m .* t17 1 / Iges(1) .* t20 1 / Iges(2) .* t18 1 / Iges(3) .* (omega(2, :) .* omega(1) .* (-Iges(2) + Iges(1)) + kQ .* (-t16 + t14 - t15 + t13))];
%hessian(cg(1), [r, q, omega, v, u])

diff(cg(1), omega(1))



